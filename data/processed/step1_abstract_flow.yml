metadata:
  source: data/processed/step0_parsed.yml
  step: 1
  description: Environment-independent abstract attack flow
abstract_flow:
  attack_goals:
  - goal: Establish initial access through compromised web application
    tactic: initial-access
    description: Exploit file upload vulnerability in bulletin board to upload web
      shell and gain server control
  - goal: Escalate privileges from web service account to system level
    tactic: privilege-escalation
    description: Exploit OS vulnerabilities to elevate from limited web service permissions
      to higher system privileges
  - goal: Establish persistence through scheduled tasks and services
    tactic: persistence
    description: Register malware in task scheduler and as system services to maintain
      access across reboots
  - goal: Erase forensic evidence of compromise
    tactic: defense-evasion
    description: Delete event logs and malware files to remove traces of attack activities
  - goal: Harvest credentials through keylogging
    tactic: credential-access
    description: Deploy keylogging malware to capture administrator and user account
      credentials as they are typed
  - goal: Gather system configuration and version information
    tactic: discovery
    description: Collect OS version, hostname, and system information to identify
      vulnerabilities and plan exploitation
  - goal: Identify current user context
    tactic: discovery
    description: Determine current user privileges and context for privilege escalation
      planning
  - goal: Discover local and domain accounts
    tactic: discovery
    description: Enumerate user accounts on compromised systems and domain to identify
      targets for credential theft
  - goal: Monitor running processes
    tactic: discovery
    description: Enumerate active processes to identify security tools and understand
      system activity
  - goal: Enumerate running services for exploitation
    tactic: discovery
    description: Query system services to identify potential targets for manipulation
      or exploitation
  - goal: Locate specific system files and directories
    tactic: discovery
    description: Search for critical system files and DLLs to assess patch levels
      and identify vulnerable components
  - goal: Map network infrastructure and configuration
    tactic: discovery
    description: Enumerate network settings, ARP tables, and hosted domains to understand
      network architecture
  - goal: Identify active network connections and sessions
    tactic: discovery
    description: Monitor established connections and active sessions to identify communication
      paths and user activity
  - goal: Enumerate remote systems and network topology
    tactic: discovery
    description: Discover other systems on the network using net view commands to
      identify lateral movement targets
  - goal: Propagate laterally via network shares
    tactic: lateral-movement
    description: Use network sharing with captured credentials or active sessions
      to access additional systems
  - goal: Collect internal corporate information and web logs
    tactic: collection
    description: Gather sensitive company data and web server logs through malware
      commands
  - goal: Capture active application windows
    tactic: collection
    description: Monitor open application windows through keylogger to identify sensitive
      applications and user activity
  - goal: Stage collected data for exfiltration
    tactic: collection
    description: Store command execution results in temporary files for subsequent
      exfiltration
  - goal: Compress data before exfiltration
    tactic: exfiltration
    description: Use Info-ZIP library to compress collected data to reduce transfer
      size and time
  - goal: Limit data transfer size to evade detection
    tactic: exfiltration
    description: Split exfiltrated data into ~90KB chunks to avoid triggering size-based
      detection rules
  - goal: Exfiltrate data over C2 channel
    tactic: exfiltration
    description: Use established command and control channel for data exfiltration
      to blend with C2 traffic
  mitre_tactics:
  - initial-access
  - privilege-escalation
  - persistence
  - defense-evasion
  - credential-access
  - discovery
  - lateral-movement
  - collection
  - exfiltration
  attack_flow_summary: Initial Access via Web Shell → Privilege Escalation → Persistence
    Establishment → Defense Evasion → Credential Harvesting → Internal Discovery →
    Lateral Movement → Data Collection → Data Exfiltration
  required_capabilities:
  - credential-theft
  - data-compression
  - data-exfiltration
  - defense-evasion
  - lateral-movement
  - network-discovery
  - persistence-mechanisms
  - privilege-escalation
  - system-discovery
  - web-exploitation
